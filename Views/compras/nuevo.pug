extends ../layout

block content
  h2.text-center.mb-4 Nueva Compra

  form(action="/compras/nuevo" method="POST" class="mx-auto" style="max-width: 600px;")
    .mb-3
      label.form-label(for="producto") Producto
      select.form-select(name="producto" id="producto" required)
        option(value="" disabled selected) Seleccione un producto
        each prod in productos
          option(value=prod._id data-codigo=prod.productoId)= `${prod.productoId} - ${prod.nombre}`

    .mb-3
      label.form-label(for="cantidad") Cantidad
      input.form-control(type="number" name="cantidad" id="cantidad" required min="1" value=1)

    .mb-3
      label.form-label(for="precioUnitario") Precio Unitario
      input.form-control(type="number" step="0.01" name="precioUnitario" id="precioUnitario" required value=0)

    .mb-3
      label.form-label(for="precioTotal") Precio Total
      input.form-control(type="number" step="0.01" id="precioTotal" readonly value=0)

    .mb-3
      label.form-label(for="proveedor") Proveedor
      input.form-control(type="text" name="proveedor" id="proveedor" required)

    .d-flex.justify-content-between.mt-4
      a.btn.btn-secondary(href="/compras") Cancelar
      button.btn.btn-nuevo(type="submit") Guardar Compra

block scripts
  script.
    const cantidadInput = document.getElementById('cantidad');
    const precioUnitarioInput = document.getElementById('precioUnitario');
    const precioTotalInput = document.getElementById('precioTotal');

    function actualizarTotal() {
      const cantidad = parseFloat(cantidadInput.value) || 0;
      const precio = parseFloat(precioUnitarioInput.value) || 0;
      precioTotalInput.value = (cantidad * precio).toFixed(2);
    }

    cantidadInput.addEventListener('input', actualizarTotal);
    precioUnitarioInput.addEventListener('input', actualizarTotal);


