extends ../layout

block content
  h2.text-center.mb-4 Editar Compra

  form(method="POST" action=`/compras/editar/${compra._id}` class="mx-auto" style="max-width: 600px;")
    .mb-3
      label.form-label(for="producto") Producto
      select.form-select(name="producto" id="producto" required)
        each producto in productos
          - const selected = compra.producto && compra.producto._id.toString() === producto._id.toString();
          option(value=producto._id selected=selected)= `${producto.productoId} - ${producto.nombre}`

    .mb-3
      label.form-label(for="cantidad") Cantidad
      input.form-control(
        type="number",
        name="cantidad",
        id="cantidad",
        value=compra.cantidad,
        required,
        min="1"
      )

    .mb-3
      label.form-label(for="precioUnitario") Precio Unitario
      input.form-control(
        type="number",
        step="0.01",
        name="precioUnitario",
        id="precioUnitario",
        value=compra.precioUnitario,
        required
      )

    .mb-3
      label.form-label(for="precioTotal") Precio Total
      input.form-control(type="number" step="0.01" id="precioTotal" readonly value=(compra.cantidad * compra.precioUnitario).toFixed(2))

    .mb-3
      label.form-label(for="proveedor") Proveedor
      input.form-control(
        type="text",
        name="proveedor",
        value=compra.proveedor,
        required
      )

    .d-flex.justify-content-between.mt-4
      a.btn.btn-secondary(href="/compras") Cancelar
      button.btn.btn-nuevo(type="submit") Guardar Cambios

block scripts
  script.
    const cantidadInput = document.getElementById('cantidad');
    const precioUnitarioInput = document.getElementById('precioUnitario');
    const precioTotalInput = document.getElementById('precioTotal');

    function actualizarTotal() {
      const cantidad = parseFloat(cantidadInput.value) || 0;
      const precio = parseFloat(precioUnitarioInput.value) || 0;
      precioTotalInput.value = (cantidad * precio).toFixed(2);
    }

    cantidadInput.addEventListener('input', actualizarTotal);
    precioUnitarioInput.addEventListener('input', actualizarTotal);



